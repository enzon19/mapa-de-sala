import{_ as Le}from"./preload-helper.a4192956.js";const Qn=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...e)=>Le(()=>Promise.resolve().then(()=>Fe),void 0,import.meta.url).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)};class St extends Error{constructor(t,e="FunctionsError",n){super(t),this.name=e,this.context=n}}class Xn extends St{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Zn extends St{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class er extends St{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var tr=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};class nr{constructor(t,{headers:e={},customFetch:n}={}){this.url=t,this.headers=e,this.fetch=Qn(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var n;return tr(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=e;let c={},u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(c["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(c["Content-Type"]="application/json",u=JSON.stringify(a)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),i),body:u}).catch(D=>{throw new Xn(D)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new Zn(f);if(!f.ok)throw new er(f);let p=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return p==="application/json"?v=yield f.json():p==="application/octet-stream"?v=yield f.blob():p==="multipart/form-data"?v=yield f.formData():v=yield f.text(),{data:v,error:null}}catch(i){return{data:null,error:i}}})}}var rr=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},we=rr();const ir=we.fetch,Tt=we.fetch.bind(we),on=we.Headers,sr=we.Request,ar=we.Response,Fe=Object.freeze(Object.defineProperty({__proto__:null,Headers:on,Request:sr,Response:ar,default:Tt,fetch:ir},Symbol.toStringTag,{value:"Module"}));class or{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Tt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,c,u;let f=null,h=null,p=null,v=s.status,D=s.statusText;if(s.ok){if(this.method!=="HEAD"){const R=await s.text();R===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?h=R:h=JSON.parse(R))}const _=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),E=(c=s.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");_&&E&&E.length>1&&(p=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(f={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,v=406,D="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const _=await s.text();try{f=JSON.parse(_),Array.isArray(f)&&s.status===404&&(h=[],f=null,v=200,D="OK")}catch{s.status===404&&_===""?(v=204,D="No Content"):f={message:_}}if(f&&this.isMaybeSingle&&(!((u=f==null?void 0:f.details)===null||u===void 0)&&u.includes("0 rows"))&&(f=null,v=200,D="OK"),f&&this.shouldThrowOnError)throw f}return{error:f,data:h,count:p,status:v,statusText:D}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,c,u;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(c=s==null?void 0:s.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(u=s==null?void 0:s.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,e)}}class lr extends or{select(t){let e=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:e=!0,nullsFirst:n,foreignTable:i}={}){const s=i?`${i}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e}={}){const n=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(n,`${t}`),this}range(t,e,{foreignTable:n}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:e=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){const c=[t?"analyze":null,e?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${c};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class ye extends lr{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){const n=e.map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,n])=>{this.url.searchParams.append(e,`eq.${n}`)}),this}not(t,e,n){return this.url.searchParams.append(t,`not.${e}.${n}`),this}or(t,{foreignTable:e}={}){const n=e?`${e}.or`:"or";return this.url.searchParams.append(n,`(${t})`),this}filter(t,e,n){return this.url.searchParams.append(t,`${e}.${n}`),this}}class cr{constructor(t,{headers:e={},schema:n,fetch:i}){this.url=t,this.headers=e,this.schema=n,this.fetch=i}select(t,{head:e=!1,count:n}={}){const i=e?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new ye({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:e,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),e&&s.push(`count=${e}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const a=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(a.length>0){const c=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new ye({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:e,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",c=[`resolution=${n?"ignore":"merge"}-duplicates`];if(e!==void 0&&this.url.searchParams.set("on_conflict",e),this.headers.Prefer&&c.push(this.headers.Prefer),i&&c.push(`count=${i}`),s||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(t)){const u=t.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(u.length>0){const f=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",f.join(","))}}return new ye({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:e}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),e&&i.push(`count=${e}`),this.headers.Prefer=i.join(","),new ye({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const e="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ye({method:e,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const ur="1.8.5",dr={"X-Client-Info":`postgrest-js/${ur}`};class Et{constructor(t,{headers:e={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},dr),e),this.schemaName=n,this.fetch=i}from(t){const e=new URL(`${this.url}/${t}`);return new cr(e,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Et(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:n=!1,count:i}={}){let s;const a=new URL(`${this.url}/rpc/${t}`);let c;n?(s="HEAD",Object.entries(e).forEach(([f,h])=>{a.searchParams.append(f,`${h}`)})):(s="POST",c=e);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new ye({method:s,url:a,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}}var hr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function is(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lt,qt;function fr(){if(qt)return lt;qt=1;var r=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return lt=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}(),lt}const gr="websocket",pr="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",mr=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],vr="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",yr=["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],_r="1.0.34",br={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},wr="https://github.com/theturtle32/WebSocket-Node",Dr={node:">=4.0.0"},kr={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Cr={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Sr={verbose:!1},Tr={test:"tape test/unit/*.js",gulp:"gulp"},Er="index",Or={lib:"./lib"},xr="lib/browser.js",Mr="Apache-2.0",jr={name:gr,description:pr,keywords:mr,author:vr,contributors:yr,version:_r,repository:br,homepage:wr,engines:Dr,dependencies:kr,devDependencies:Cr,config:Sr,scripts:Tr,main:Er,directories:Or,browser:xr,license:Mr};var Ar=jr.version,oe;if(typeof globalThis=="object")oe=globalThis;else try{oe=fr()}catch{}finally{if(!oe&&typeof window<"u"&&(oe=window),!oe)throw new Error("Could not determine global this")}var Pe=oe.WebSocket||oe.MozWebSocket,Ir=Ar;function ln(r,t){var e;return t?e=new Pe(r,t):e=new Pe(r),e}Pe&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(r){Object.defineProperty(ln,r,{get:function(){return Pe[r]}})});var Pr={w3cwebsocket:Pe?ln:null,version:Ir};const $r="2.8.4",Rr={"X-Client-Info":`realtime-js/${$r}`},Lr="1.0.0",cn=1e4,Fr=1e3;var Me;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Me||(Me={}));var z;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(z||(z={}));var G;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(G||(G={}));var _t;(function(r){r.websocket="websocket"})(_t||(_t={}));var le;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(le||(le={}));class un{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Nr{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,e,n)}_decodeBroadcast(t,e,n){const i=e.getUint8(1),s=e.getUint8(2);let a=this.HEADER_LENGTH+2;const c=n.decode(t.slice(a,a+i));a=a+i;const u=n.decode(t.slice(a,a+s));a=a+s;const f=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:c,event:u,payload:f}}}class ct{constructor(t,e,n={},i=cn){this.channel=t,this.event=e,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var n;return this._hasReceived(t)&&e((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Jt;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Jt||(Jt={}));class je{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=je.syncState(this.state,i,s,a),this.pendingDiffs.forEach(u=>{this.state=je.syncDiff(this.state,u,s,a)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=je.syncDiff(this.state,i,s,a),c())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,n,i){const s=this.cloneDeep(t),a=this.transformState(e),c={},u={};return this.map(s,(f,h)=>{a[f]||(u[f]=h)}),this.map(a,(f,h)=>{const p=s[f];if(p){const v=h.map(E=>E.presence_ref),D=p.map(E=>E.presence_ref),T=h.filter(E=>D.indexOf(E.presence_ref)<0),_=p.filter(E=>v.indexOf(E.presence_ref)<0);T.length>0&&(c[f]=T),_.length>0&&(u[f]=_)}else c[f]=h}),this.syncDiff(s,{joins:c,leaves:u},n,i)}static syncDiff(t,e,n,i){const{joins:s,leaves:a}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(c,u)=>{var f;const h=(f=t[c])!==null&&f!==void 0?f:[];if(t[c]=this.cloneDeep(u),h.length>0){const p=t[c].map(D=>D.presence_ref),v=h.filter(D=>p.indexOf(D.presence_ref)<0);t[c].unshift(...v)}n(c,h,u)}),this.map(a,(c,u)=>{let f=t[c];if(!f)return;const h=u.map(p=>p.presence_ref);f=f.filter(p=>h.indexOf(p.presence_ref)<0),t[c]=f,i(c,f,u),f.length===0&&delete t[c]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(n=>e(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,n)=>{const i=t[n];return"metas"in i?e[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[n]=i,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var A;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(A||(A={}));const Bt=(r,t,e={})=>{var n;const i=(n=e.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=Ur(a,r,t,i),s),{})},Ur=(r,t,e,n)=>{const i=t.find(c=>c.name===r),s=i==null?void 0:i.type,a=e[r];return s&&!n.includes(s)?dn(s,a):bt(a)},dn=(r,t)=>{if(r.charAt(0)==="_"){const e=r.slice(1,r.length);return Jr(t,e)}switch(r){case A.bool:return Hr(t);case A.float4:case A.float8:case A.int2:case A.int4:case A.int8:case A.numeric:case A.oid:return Yr(t);case A.json:case A.jsonb:return qr(t);case A.timestamp:return Br(t);case A.abstime:case A.date:case A.daterange:case A.int4range:case A.int8range:case A.money:case A.reltime:case A.text:case A.time:case A.timestamptz:case A.timetz:case A.tsrange:case A.tstzrange:return bt(t);default:return bt(t)}},bt=r=>r,Hr=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Yr=r=>{if(typeof r=="string"){const t=parseFloat(r);if(!Number.isNaN(t))return t}return r},qr=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(t){return console.log(`JSON parse error: ${t}`),r}return r},Jr=(r,t)=>{if(typeof r!="string")return r;const e=r.length-1,n=r[e];if(r[0]==="{"&&n==="}"){let s;const a=r.slice(1,e);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(c=>dn(t,c))}return r},Br=r=>typeof r=="string"?r.replace(" ","T"):r;var zt;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(zt||(zt={}));var Kt;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes"})(Kt||(Kt={}));var Wt;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Wt||(Wt={}));class Ot{constructor(t,e={config:{}},n){this.topic=t,this.params=e,this.socket=n,this.bindings={},this.state=z.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},e.config),this.timeout=this.socket.timeout,this.joinPush=new ct(this,G.join,this.params,this.timeout),this.rejoinTimer=new un(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=z.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=z.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=z.errored,this.rejoinTimer.scheduleTimeout())}),this._on(G.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new je(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(t,e=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a}}=this.params;this._onError(f=>t&&t("CHANNEL_ERROR",f)),this._onClose(()=>t&&t("CLOSED"));const c={},u={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[]};this.socket.accessToken&&(c.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",({postgres_changes:f})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),f===void 0){t&&t("SUBSCRIBED");return}else{const p=this.bindings.postgres_changes,v=(h=p==null?void 0:p.length)!==null&&h!==void 0?h:0,D=[];for(let T=0;T<v;T++){const _=p[T],{filter:{event:E,schema:R,table:L,filter:F}}=_,I=f&&f[T];if(I&&I.event===E&&I.schema===R&&I.table===L&&I.filter===F)D.push(Object.assign(Object.assign({},_),{id:I.id}));else{this.unsubscribe(),t&&t("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=D,t&&t("SUBSCRIBED");return}}).receive("error",f=>{t&&t("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t&&t("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,n){return this._on(t,e,n)}async send(t,e={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,c={method:"POST",headers:{apikey:(n=this.socket.accessToken)!==null&&n!==void 0?n:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,c,(i=e.timeout)!==null&&i!==void 0?i:this.timeout)).ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,c,u;const f=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((u=(c=(a=this.params)===null||a===void 0?void 0:a.config)===null||c===void 0?void 0:c.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=z.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(G.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new ct(this,G.leave,{},t);i.receive("ok",()=>{e(),n("ok")}).receive("timeout",()=>{e(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_broadcastEndpointURL(){let t=this.socket.endPoint;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(t,e,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:i.signal}));return clearTimeout(s),a}_push(t,e,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ct(this,t,e,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,e,n){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,n){var i,s;const a=t.toLocaleLowerCase(),{close:c,error:u,leave:f,join:h}=G;if(n&&[c,u,f,h].indexOf(a)>=0&&n!==this._joinRef())return;let v=this._onMessage(a,e,n);if(e&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(D=>{var T,_,E;return((T=D.filter)===null||T===void 0?void 0:T.event)==="*"||((E=(_=D.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===a}).map(D=>D.callback(v,n)):(s=this.bindings[a])===null||s===void 0||s.filter(D=>{var T,_,E,R,L,F;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in D){const I=D.id,Z=(T=D.filter)===null||T===void 0?void 0:T.event;return I&&((_=e.ids)===null||_===void 0?void 0:_.includes(I))&&(Z==="*"||(Z==null?void 0:Z.toLocaleLowerCase())===((E=e.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const I=(L=(R=D==null?void 0:D.filter)===null||R===void 0?void 0:R.event)===null||L===void 0?void 0:L.toLocaleLowerCase();return I==="*"||I===((F=e==null?void 0:e.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return D.type.toLocaleLowerCase()===a}).map(D=>{if(typeof v=="object"&&"ids"in v){const T=v.data,{schema:_,table:E,commit_timestamp:R,type:L,errors:F}=T;v=Object.assign(Object.assign({},{schema:_,table:E,commit_timestamp:R,eventType:L,new:{},old:{},errors:F}),this._getPayloadRecords(T))}D.callback(v,n)})}_isClosed(){return this.state===z.closed}_isJoined(){return this.state===z.joined}_isJoining(){return this.state===z.joining}_isLeaving(){return this.state===z.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,n){const i=t.toLocaleLowerCase(),s={type:i,filter:e,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,e){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Ot.isEqual(i.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(G.close,{},t)}_onError(t){this._on(G.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=z.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Bt(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Bt(t.columns,t.old_record)),e}}const zr=()=>{};class Kr{constructor(t,e){var n;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Rr,this.params={},this.timeout=cn,this.transport=Pr.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=zr,this.conn=null,this.sendBuffer=[],this.serializer=new Nr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...c)=>Le(()=>Promise.resolve().then(()=>Fe),void 0,import.meta.url).then(({default:u})=>u(...c)):a=fetch,(...c)=>a(...c)},this.endPoint=`${t}/${_t.websocket}`,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.transport&&(this.transport=e.transport),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const i=(n=e==null?void 0:e.params)===null||n===void 0?void 0:n.apikey;i&&(this.accessToken=i),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(s,a)=>a(JSON.stringify(s)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new un(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(e==null?void 0:e.fetch)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t)))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t}log(t,e,n){this.logger(t,e,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Me.connecting:return le.Connecting;case Me.open:return le.Open;case Me.closing:return le.Closing;default:return le.Closed}}isConnected(){return this.connectionState()===le.Open}channel(t,e={config:{}}){const n=new Ot(`realtime:${t}`,e,this);return this.channels.push(n),n}push(t){const{topic:e,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,c=>{var u;(u=this.conn)===null||u===void 0||u.send(c)})};this.log("push",`${e} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(t){this.accessToken=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(G.access_token,{access_token:t})})}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Lr}))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:n,event:i,payload:s,ref:a}=e;(a&&a===this.pendingHeartbeatRef||i===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(c=>c(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(G.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(e);return`${t}${n}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(Fr,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class xt extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function N(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Wr extends xt{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Gt extends xt{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var Gr=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};const hn=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...e)=>Le(()=>Promise.resolve().then(()=>Fe),void 0,import.meta.url).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)},Vr=()=>Gr(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Le(()=>Promise.resolve().then(()=>Fe),void 0,import.meta.url)).Response:Response});var De=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};const ut=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Qr=(r,t)=>De(void 0,void 0,void 0,function*(){const e=yield Vr();r instanceof e?r.json().then(n=>{t(new Wr(ut(n),r.status||500))}).catch(n=>{t(new Gt(ut(n),n))}):t(new Gt(ut(r),r))}),Xr=(r,t,e,n)=>{const i={method:r,headers:(t==null?void 0:t.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),e))};function Xe(r,t,e,n,i,s){return De(this,void 0,void 0,function*(){return new Promise((a,c)=>{r(e,Xr(t,n,i,s)).then(u=>{if(!u.ok)throw u;return n!=null&&n.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>Qr(u,c))})})}function wt(r,t,e,n){return De(this,void 0,void 0,function*(){return Xe(r,"GET",t,e,n)})}function te(r,t,e,n,i){return De(this,void 0,void 0,function*(){return Xe(r,"POST",t,n,i,e)})}function Zr(r,t,e,n,i){return De(this,void 0,void 0,function*(){return Xe(r,"PUT",t,n,i,e)})}function fn(r,t,e,n,i){return De(this,void 0,void 0,function*(){return Xe(r,"DELETE",t,n,i,e)})}var K=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};const ei={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ti{constructor(t,e={},n,i){this.url=t,this.headers=e,this.bucketId=n,this.fetch=hn(i)}uploadOrUpdate(t,e,n,i){return K(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Vt),i),c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl)):(s=n,c["cache-control"]=`max-age=${a.cacheControl}`,c["content-type"]=a.contentType);const u=this._removeEmptyFolders(e),f=this._getFinalPath(u),h=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:c},a!=null&&a.duplex?{duplex:a.duplex}:{}));return h.ok?{data:{path:u},error:null}:{data:null,error:yield h.json()}}catch(s){if(N(s))return{data:null,error:s};throw s}})}upload(t,e,n){return K(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,n)})}uploadToSignedUrl(t,e,n,i){return K(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${a}`);c.searchParams.set("token",e);try{let u;const f=Object.assign({upsert:Vt.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(u=new FormData,u.append("cacheControl",f.cacheControl),u.append("",n)):typeof FormData<"u"&&n instanceof FormData?(u=n,u.append("cacheControl",f.cacheControl)):(u=n,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType);const p=yield this.fetch(c.toString(),{method:"PUT",body:u,headers:h});return p.ok?{data:{path:s},error:null}:{data:null,error:yield p.json()}}catch(u){if(N(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(t){return K(this,void 0,void 0,function*(){try{let e=this._getFinalPath(t);const n=yield te(this.fetch,`${this.url}/object/upload/sign/${e}`,{},{headers:this.headers}),i=new URL(this.url+n.url),s=i.searchParams.get("token");if(!s)throw new xt("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:s},error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}update(t,e,n){return K(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,n)})}move(t,e){return K(this,void 0,void 0,function*(){try{return{data:yield te(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}copy(t,e){return K(this,void 0,void 0,function*(){try{return{data:{path:(yield te(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e},{headers:this.headers})).Key},error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}createSignedUrl(t,e,n){return K(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield te(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:e},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(N(i))return{data:null,error:i};throw i}})}createSignedUrls(t,e,n){return K(this,void 0,void 0,function*(){try{const i=yield te(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(N(i))return{data:null,error:i};throw i}})}download(t,e){return K(this,void 0,void 0,function*(){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),a=s?`?${s}`:"";try{const c=this._getFinalPath(t);return{data:yield(yield wt(this.fetch,`${this.url}/${i}/${c}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(N(c))return{data:null,error:c};throw c}})}getPublicUrl(t,e){const n=this._getFinalPath(t),i=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const c=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});u!==""&&i.push(u);let f=i.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${n}${f}`)}}}remove(t){return K(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}list(t,e,n){return K(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},ei),e),{prefix:t||""});return{data:yield te(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(N(i))return{data:null,error:i};throw i}})}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const ni="2.5.4",ri={"X-Client-Info":`storage-js/${ni}`};var ge=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};class ii{constructor(t,e={},n){this.url=t,this.headers=Object.assign(Object.assign({},ri),e),this.fetch=hn(n)}listBuckets(){return ge(this,void 0,void 0,function*(){try{return{data:yield wt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(N(t))return{data:null,error:t};throw t}})}getBucket(t){return ge(this,void 0,void 0,function*(){try{return{data:yield wt(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return ge(this,void 0,void 0,function*(){try{return{data:yield te(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}updateBucket(t,e){return ge(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(N(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ge(this,void 0,void 0,function*(){try{return{data:yield te(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}deleteBucket(t){return ge(this,void 0,void 0,function*(){try{return{data:yield fn(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}}class si extends ii{constructor(t,e={},n){super(t,e,n)}from(t){return new ti(this.url,this.headers,t,this.fetch)}}const ai="2.38.4";let Oe="";typeof Deno<"u"?Oe="deno":typeof document<"u"?Oe="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Oe="react-native":Oe="node";const oi={"X-Client-Info":`supabase-js-${Oe}/${ai}`};var li=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};const ci=r=>{let t;return r?t=r:typeof fetch>"u"?t=Tt:t=fetch,(...e)=>t(...e)},ui=()=>typeof Headers>"u"?on:Headers,di=(r,t,e)=>{const n=ci(e),i=ui();return(s,a)=>li(void 0,void 0,void 0,function*(){var c;const u=(c=yield t())!==null&&c!==void 0?c:r;let f=new i(a==null?void 0:a.headers);return f.has("apikey")||f.set("apikey",r),f.has("Authorization")||f.set("Authorization",`Bearer ${u}`),n(s,Object.assign(Object.assign({},a),{headers:f}))})};function hi(r){return r.replace(/\/$/,"")}function fi(r,t){const{db:e,auth:n,realtime:i,global:s}=r,{db:a,auth:c,realtime:u,global:f}=t;return{db:Object.assign(Object.assign({},a),e),auth:Object.assign(Object.assign({},c),n),realtime:Object.assign(Object.assign({},u),i),global:Object.assign(Object.assign({},f),s)}}function gi(r){return Math.round(Date.now()/1e3)+r}function pi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=Math.random()*16|0;return(r=="x"?t:t&3|8).toString(16)})}const X=()=>typeof document<"u",se={tested:!1,writable:!1},Ae=()=>{if(!X())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(se.tested)return se.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),se.tested=!0,se.writable=!0}catch{se.tested=!0,se.writable=!1}return se.writable};function dt(r){const t={},e=new URL(r);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return e.searchParams.forEach((n,i)=>{t[i]=n}),t}const gn=r=>{let t;return r?t=r:typeof fetch>"u"?t=(...e)=>Le(()=>Promise.resolve().then(()=>Fe),void 0,import.meta.url).then(({default:n})=>n(...e)):t=fetch,(...e)=>t(...e)},mi=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",ae=async(r,t,e)=>{await r.setItem(t,JSON.stringify(e))},ze=async(r,t)=>{const e=await r.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},ht=async(r,t)=>{await r.removeItem(t)};function vi(r){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",n,i,s,a,c,u,f,h=0;for(r=r.replace("-","+").replace("_","/");h<r.length;)a=t.indexOf(r.charAt(h++)),c=t.indexOf(r.charAt(h++)),u=t.indexOf(r.charAt(h++)),f=t.indexOf(r.charAt(h++)),n=a<<2|c>>4,i=(c&15)<<4|u>>2,s=(u&3)<<6|f,e=e+String.fromCharCode(n),u!=64&&i!=0&&(e=e+String.fromCharCode(i)),f!=64&&s!=0&&(e=e+String.fromCharCode(s));return e}class Ze{constructor(){this.promise=new Ze.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}Ze.promiseConstructor=Promise;function Qt(r){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=r.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=e[1];return JSON.parse(vi(n))}async function yi(r){return await new Promise(t=>{setTimeout(()=>t(null),r)})}function _i(r,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await r(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function bi(r){return("0"+r.toString(16)).substr(-2)}function pe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=e.length;let i="";for(let s=0;s<56;s++)i+=e.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,bi).join("")}async function wi(r){const e=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",e),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}function Di(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function me(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const e=await wi(r);return Di(e)}class Mt extends Error{constructor(t,e){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e}}function O(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class ki extends Mt{constructor(t,e){super(t,e),this.name="AuthApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Ci(r){return O(r)&&r.name==="AuthApiError"}class pn extends Mt{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class ke extends Mt{constructor(t,e,n){super(t),this.name=e,this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ve extends ke{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class ft extends ke{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class Ke extends ke{constructor(t){super(t,"AuthInvalidCredentialsError",400)}}class We extends ke{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xt extends ke{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Dt extends ke{constructor(t,e){super(t,"AuthRetryableFetchError",e)}}function Zt(r){return O(r)&&r.name==="AuthRetryableFetchError"}var Si=globalThis&&globalThis.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};const xe=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ti=[502,503,504];async function en(r){if(!mi(r))throw new Dt(xe(r),0);if(Ti.includes(r.status))throw new Dt(xe(r),r.status);let t;try{t=await r.json()}catch(e){throw new pn(xe(e),e)}throw new ki(xe(t),r.status||500)}const Ei=(r,t,e,n)=>{const i={method:r,headers:(t==null?void 0:t.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),e))};async function x(r,t,e,n){var i;const s=Object.assign({},n==null?void 0:n.headers);n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const c=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await Oi(r,t,e+c,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(u):{data:Object.assign({},u),error:null}}async function Oi(r,t,e,n,i,s){const a=Ei(t,n,i,s);let c;try{c=await r(e,a)}catch(u){throw console.error(u),new Dt(xe(u),0)}if(c.ok||await en(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(u){await en(u)}}function ee(r){var t;let e=null;Ai(r)&&(e=Object.assign({},r),r.expires_at||(e.expires_at=gi(r.expires_in)));const n=(t=r.user)!==null&&t!==void 0?t:r;return{data:{session:e,user:n},error:null}}function ne(r){var t;return{data:{user:(t=r.user)!==null&&t!==void 0?t:r},error:null}}function xi(r){return{data:r,error:null}}function Mi(r){const{action_link:t,email_otp:e,hashed_token:n,redirect_to:i,verification_type:s}=r,a=Si(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:e,hashed_token:n,redirect_to:i,verification_type:s},u=Object.assign({},a);return{data:{properties:c,user:u},error:null}}function ji(r){return r}function Ai(r){return r.access_token&&r.refresh_token&&r.expires_in}var Ii=globalThis&&globalThis.__rest||function(r,t){var e={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(e[n[i]]=r[n[i]]);return e};class Pi{constructor({url:t="",headers:e={},fetch:n}){this.url=t,this.headers=e,this.fetch=gn(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,e="global"){try{return await x(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,e={}){try{return await x(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:ne})}catch(n){if(O(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:e}=t,n=Ii(t,["options"]),i=Object.assign(Object.assign({},n),e);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await x(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Mi,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(O(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await x(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ne})}catch(e){if(O(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,n,i,s,a,c,u;try{const f={nextPage:null,lastPage:0,total:0},h=await x(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:ji});if(h.error)throw h.error;const p=await h.json(),v=(a=h.headers.get("x-total-count"))!==null&&a!==void 0?a:0,D=(u=(c=h.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&u!==void 0?u:[];return D.length>0&&(D.forEach(T=>{const _=parseInt(T.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(T.split(";")[1].split("=")[1]);f[`${E}Page`]=_}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(O(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){try{return await x(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ne})}catch(e){if(O(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){try{return await x(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:ne})}catch(n){if(O(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,e=!1){try{return await x(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:ne})}catch(n){if(O(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:e,error:n}=await x(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:e,error:n}}catch(e){if(O(e))return{data:null,error:e};throw e}}async _deleteFactor(t){try{return{data:await x(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(O(e))return{data:null,error:e};throw e}}}const mn="2.57.0",$i="http://localhost:9999",Ri="supabase.auth.token",Li={"X-Client-Info":`gotrue-js/${mn}`},tn=10,Fi={getItem:r=>Ae()?globalThis.localStorage.getItem(r):null,setItem:(r,t)=>{Ae()&&globalThis.localStorage.setItem(r,t)},removeItem:r=>{Ae()&&globalThis.localStorage.removeItem(r)}};function nn(r={}){return{getItem:t=>r[t]||null,setItem:(t,e)=>{r[t]=e},removeItem:t=>{delete r[t]}}}function Ni(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}globalThis&&Ae()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug");class Ui extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}Ni();const Hi={url:$i,storageKey:Ri,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Li,flowType:"implicit",debug:!1},Ee=30*1e3,rn=3;async function Yi(r,t,e){return await e()}class $e{constructor(t){var e;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=$e.nextInstanceID,$e.nextInstanceID+=1,this.instanceID>0&&X()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Hi),t);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Pi({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=gn(n.fetch),this.lock=n.lock||Yi,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ae()?this.storage=Fi:(this.memoryStorage={},this.storage=nn(this.memoryStorage)):(this.memoryStorage={},this.storage=nn(this.memoryStorage)),X()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(e=this.broadcastChannel)===null||e===void 0||e.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${mn}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const t=X()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",t),t||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:e,error:n}=await this._getSessionFromURL(t);if(n)return this._debug("#_initialize()","error detecting session from URL",n),await this._removeSession(),{error:n};const{session:i,redirectType:s}=e;return this._debug("#_initialize()","detected session in URL",i,"redirect type",s),await this._saveSession(i),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return O(t)?{error:t}:{error:new pn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(t){var e,n,i;try{await this._removeSession();let s;if("email"in t){const{email:h,password:p,options:v}=t;let D=null,T=null;if(this.flowType==="pkce"){const _=pe();await ae(this.storage,`${this.storageKey}-code-verifier`,_),D=await me(_),T=_===D?"plain":"s256"}s=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:h,password:p,data:(e=v==null?void 0:v.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:D,code_challenge_method:T},xform:ee})}else if("phone"in t){const{phone:h,password:p,options:v}=t;s=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},channel:(i=v==null?void 0:v.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:ee})}else throw new Ke("You must provide either an email or phone number and a password");const{data:a,error:c}=s;if(c||!a)return{data:{user:null,session:null},error:c};const u=a.session,f=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(s){if(O(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{await this._removeSession();let e;if("email"in t){const{email:s,password:a,options:c}=t;e=await x(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ee})}else if("phone"in t){const{phone:s,password:a,options:c}=t;e=await x(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ee})}else throw new Ke("You must provide either an email or phone number and a password");const{data:n,error:i}=e;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ft}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:{user:n.user,session:n.session},error:i})}catch(e){if(O(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(t){var e,n,i,s;return await this._removeSession(),await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const e=await ze(this.storage,`${this.storageKey}-code-verifier`),{data:n,error:i}=await x(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:e},xform:ee});return await ht(this.storage,`${this.storageKey}-code-verifier`),i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new ft}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:n,error:i})}async signInWithIdToken(t){await this._removeSession();try{const{options:e,provider:n,token:i,access_token:s,nonce:a}=t,c=await x(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:ee}),{data:u,error:f}=c;return f?{data:{user:null,session:null},error:f}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new ft}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:f})}catch(e){if(O(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(t){var e,n,i,s,a;try{if(await this._removeSession(),"email"in t){const{email:c,options:u}=t;let f=null,h=null;if(this.flowType==="pkce"){const v=pe();await ae(this.storage,`${this.storageKey}-code-verifier`,v),f=await me(v),h=v===f?"plain":"s256"}const{error:p}=await x(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(e=u==null?void 0:u.data)!==null&&e!==void 0?e:{},create_user:(n=u==null?void 0:u.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:f,code_challenge_method:h},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in t){const{phone:c,options:u}=t,{data:f,error:h}=await x(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(i=u==null?void 0:u.data)!==null&&i!==void 0?i:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:h}}throw new Ke("You must provide either an email or phone number.")}catch(c){if(O(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var e,n;try{t.type!=="email_change"&&t.type!=="phone_change"&&await this._removeSession();let i,s;"options"in t&&(i=(e=t.options)===null||e===void 0?void 0:e.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:c}=await x(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:ee});if(c)throw c;if(!a)throw new Error("An error occurred on token verification.");const u=a.session,f=a.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:f,session:u},error:null}}catch(i){if(O(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var e,n,i;try{await this._removeSession();let s=null,a=null;if(this.flowType==="pkce"){const c=pe();await ae(this.storage,`${this.storageKey}-code-verifier`,c),s=await me(c),a=c===s?"plain":"s256"}return await x(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:xi})}catch(s){if(O(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:n}=t;if(n)throw n;if(!e)throw new ve;const{error:i}=await x(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{t.type!="email_change"&&t.type!="phone_change"&&await this._removeSession();const e=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await x(this.fetch,"POST",e,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:c}=await x(this.fetch,"POST",e,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:c}}throw new Ke("You must provide either an email or phone number and a type")}catch(e){if(O(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await e()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=e();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await ze(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n)return{data:{session:t},error:null};const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await x(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ne}):await this._useSession(async e=>{var n,i;const{data:s,error:a}=e;if(a)throw a;return await x(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:ne})})}catch(e){if(O(e))return{data:{user:null},error:e};throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new ve;const a=i.session;let c=null,u=null;if(this.flowType==="pkce"&&t.email!=null){const p=pe();await ae(this.storage,`${this.storageKey}-code-verifier`,p),c=await me(p),u=p===c?"plain":"s256"}const{data:f,error:h}=await x(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:u}),jwt:a.access_token,xform:ne});if(h)throw h;return a.user=f.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(O(n))return{data:{user:null},error:n};throw n}}_decodeJWT(t){return Qt(t)}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ve;const e=Date.now()/1e3;let n=e,i=!0,s=null;const a=Qt(t.access_token);if(a.exp&&(n=a.exp,i=n<=e),i){const{session:c,error:u}=await this._callRefreshToken(t.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:u}=await this._getUser(t.access_token);if(u)throw u;s={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:n-e,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(O(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var n;if(!t){const{data:a,error:c}=e;if(c)throw c;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ve;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(O(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(t){try{if(!X())throw new We("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new We("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!t)throw new Xt("Not a valid PKCE flow url.");const e=dt(window.location.href);if(t){if(!e.code)throw new Xt("No code detected.");const{data:L,error:F}=await this._exchangeCodeForSession(e.code);if(F)throw F;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:L.session,redirectType:null},error:null}}if(e.error||e.error_description||e.error_code)throw new We(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:c,expires_at:u,token_type:f}=e;if(!s||!c||!a||!f)throw new We("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(c);let v=h+p;u&&(v=parseInt(u));const D=v-h;D*1e3<=Ee&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${D}s, should have been closer to ${p}s`);const T=v-p;h-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,v,h):h-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",T,v,h);const{data:_,error:E}=await this._getUser(s);if(E)throw E;const R={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:p,expires_at:v,refresh_token:a,token_type:f,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:e.type},error:null}}catch(e){if(O(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantFlow(){const t=dt(window.location.href);return!!(X()&&(t.access_token||t.error_description))}async _isPKCEFlow(){const t=dt(window.location.href),e=await ze(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var n;const{data:i,error:s}=e;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:c}=await this.admin.signOut(a,t);if(c&&!(Ci(c)&&(c.status===404||c.status===401)))return{error:c}}return t!=="others"&&(await this._removeSession(),await ht(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(t){const e=pi(),n={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async e=>{var n,i;try{const{data:{session:s},error:a}=e;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,e={}){let n=null,i=null;if(this.flowType==="pkce"){const s=pe();await ae(this.storage,`${this.storageKey}-code-verifier`,s),n=await me(s),i=s===n?"plain":"s256"}try{return await x(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(s){if(O(s))return{data:null,error:s};throw s}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const n=Date.now();return await _i(async i=>(await yi(i*200),this._debug(e,"refreshing attempt",i),await x(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ee})),(i,s,a)=>a&&a.error&&Zt(a.error)&&Date.now()+(i+1)*200-n<Ee)}catch(n){if(this._debug(e,"error",n),O(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const n=await this._getUrlForProvider(t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",n),X()&&!e.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const e="#_recoverAndRefresh()";this._debug(e,"begin");try{const n=await ze(this.storage,this.storageKey);if(this._debug(e,"session from storage",n),!this._isValidSession(n)){this._debug(e,"session is not valid"),n!==null&&await this._removeSession();return}const i=Math.round(Date.now()/1e3),s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)<i+tn;if(this._debug(e,`session has${s?"":" not"} expired with margin of ${tn}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:a}=await this._callRefreshToken(n.refresh_token);a&&(console.error(a),Zt(a)||(this._debug(e,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(e,"error",n),console.error(n);return}finally{this._debug(e,"end")}}async _callRefreshToken(t){var e,n;if(!t)throw new ve;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ze;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new ve;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(i,"error",s),O(s)){const a={session:null,error:s};return(e=this.refreshingDeferred)===null||e===void 0||e.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,e,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",e,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:e});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,e)}catch(u){s.push(u)}});if(await Promise.all(a),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),await this._persistSession(t)}_persistSession(t){return this._debug("#_persistSession()",t),ae(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await ht(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&X()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ee);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Ee);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Ee}ms, refresh threshold is ${rn} ticks`),i<=rn&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ui)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!X()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e){const n=[`provider=${encodeURIComponent(t)}`];if(e!=null&&e.redirectTo&&n.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e!=null&&e.scopes&&n.push(`scopes=${encodeURIComponent(e.scopes)}`),this.flowType==="pkce"){const i=pe();await ae(this.storage,`${this.storageKey}-code-verifier`,i);const s=await me(i),a=i===s?"plain":"s256";this._debug("PKCE","code verifier",`${i.substring(0,5)}...`,"code challenge",s,"method",a);const c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(c.toString())}if(e!=null&&e.queryParams){const i=new URLSearchParams(e.queryParams);n.push(i.toString())}return`${this.url}/authorize?${n.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var n;const{data:i,error:s}=e;return s?{data:null,error:s}:await x(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(O(e))return{data:null,error:e};throw e}}async _enroll(t){try{return await this._useSession(async e=>{var n,i;const{data:s,error:a}=e;if(a)return{data:null,error:a};const{data:c,error:u}=await x(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:t.friendlyName,factor_type:t.factorType,issuer:t.issuer},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(e){if(O(e))return{data:null,error:e};throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:i,error:s}=e;if(s)return{data:null,error:s};const{data:a,error:c}=await x(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:c})})}catch(e){if(O(e))return{data:null,error:e};throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var n;const{data:i,error:s}=e;return s?{data:null,error:s}:await x(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(e){if(O(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(t){const{data:e,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){const{data:{user:t},error:e}=await this.getUser();if(e)return{data:null,error:e};const n=(t==null?void 0:t.factors)||[],i=n.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:n,totp:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var e,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(i.access_token);let c=null;a.aal&&(c=a.aal);let u=c;((n=(e=i.user.factors)===null||e===void 0?void 0:e.filter(p=>p.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(u="aal2");const h=a.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:h},error:null}}))}}$e.nextInstanceID=0;class qi extends $e{constructor(t){super(t)}}var Ji=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(s){return s instanceof e?s:new e(function(a){a(s)})}return new(e||(e=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(p){a(p)}}function u(h){try{f(n.throw(h))}catch(p){a(p)}}function f(h){h.done?s(h.value):i(h.value).then(c,u)}f((n=n.apply(r,t||[])).next())})};const Bi={headers:oi},zi={schema:"public"},Ki={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wi={};class Gi{constructor(t,e,n){var i,s,a,c,u,f,h,p;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const v=hi(t);this.realtimeUrl=`${v}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${v}/auth/v1`,this.storageUrl=`${v}/storage/v1`,this.functionsUrl=`${v}/functions/v1`;const D=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,T={db:zi,realtime:Wi,auth:Object.assign(Object.assign({},Ki),{storageKey:D}),global:Bi},_=fi(n??{},T);this.storageKey=(s=(i=_.auth)===null||i===void 0?void 0:i.storageKey)!==null&&s!==void 0?s:"",this.headers=(c=(a=_.global)===null||a===void 0?void 0:a.headers)!==null&&c!==void 0?c:{},this.auth=this._initSupabaseAuthClient((u=_.auth)!==null&&u!==void 0?u:{},this.headers,(f=_.global)===null||f===void 0?void 0:f.fetch),this.fetch=di(e,this._getAccessToken.bind(this),(h=_.global)===null||h===void 0?void 0:h.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},_.realtime)),this.rest=new Et(`${v}/rest/v1`,{headers:this.headers,schema:(p=_.db)===null||p===void 0?void 0:p.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new nr(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new si(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},n){return this.rest.rpc(t,e,n)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return Ji(this,void 0,void 0,function*(){const{data:n}=yield this.auth.getSession();return(e=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,debug:c},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qi({url:this.authUrl,headers:Object.assign(Object.assign({},h),u),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:n,storage:i,flowType:a,debug:c,fetch:f})}_initRealtimeClient(t){return new Kr(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,n)=>{this._handleTokenChanged(e,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,e,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.realtime.setAuth(n??null),this.changedAccessToken=n):t==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Vi=(r,t,e)=>new Gi(r,t,e),ss=Vi("https://zbbwhvjmqadagyoycfil.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpiYndodmptcWFkYWd5b3ljZmlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE2Nzc3MTQ5NjcsImV4cCI6MTk5MzI5MDk2N30.LRSDU7mJnXQk4x37aHVBNyifBW-S1gWiFkdbdkrTsOE");var gt=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],_e={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(r){return typeof console<"u"&&console.warn(r)},getWeek:function(r){var t=new Date(r.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var e=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},Re={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(r){var t=r%100;if(t>3&&t<21)return"th";switch(t%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Y=function(r,t){return t===void 0&&(t=2),("000"+r).slice(t*-1)},W=function(r){return r===!0?1:0};function sn(r,t){var e;return function(){var n=this,i=arguments;clearTimeout(e),e=setTimeout(function(){return r.apply(n,i)},t)}}var pt=function(r){return r instanceof Array?r:[r]};function H(r,t,e){if(e===!0)return r.classList.add(t);r.classList.remove(t)}function M(r,t,e){var n=window.document.createElement(r);return t=t||"",e=e||"",n.className=t,e!==void 0&&(n.textContent=e),n}function Ge(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function vn(r,t){if(t(r))return r;if(r.parentNode)return vn(r.parentNode,t)}function Ve(r,t){var e=M("div","numInputWrapper"),n=M("input","numInput "+r),i=M("span","arrowUp"),s=M("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?n.type="number":(n.type="text",n.pattern="\\d*"),t!==void 0)for(var a in t)n.setAttribute(a,t[a]);return e.appendChild(n),e.appendChild(i),e.appendChild(s),e}function J(r){try{if(typeof r.composedPath=="function"){var t=r.composedPath();return t[0]}return r.target}catch{return r.target}}var mt=function(){},Qe=function(r,t,e){return e.months[t?"shorthand":"longhand"][r]},Qi={D:mt,F:function(r,t,e){r.setMonth(e.months.longhand.indexOf(t))},G:function(r,t){r.setHours((r.getHours()>=12?12:0)+parseFloat(t))},H:function(r,t){r.setHours(parseFloat(t))},J:function(r,t){r.setDate(parseFloat(t))},K:function(r,t,e){r.setHours(r.getHours()%12+12*W(new RegExp(e.amPM[1],"i").test(t)))},M:function(r,t,e){r.setMonth(e.months.shorthand.indexOf(t))},S:function(r,t){r.setSeconds(parseFloat(t))},U:function(r,t){return new Date(parseFloat(t)*1e3)},W:function(r,t,e){var n=parseInt(t),i=new Date(r.getFullYear(),0,2+(n-1)*7,0,0,0,0);return i.setDate(i.getDate()-i.getDay()+e.firstDayOfWeek),i},Y:function(r,t){r.setFullYear(parseFloat(t))},Z:function(r,t){return new Date(t)},d:function(r,t){r.setDate(parseFloat(t))},h:function(r,t){r.setHours((r.getHours()>=12?12:0)+parseFloat(t))},i:function(r,t){r.setMinutes(parseFloat(t))},j:function(r,t){r.setDate(parseFloat(t))},l:mt,m:function(r,t){r.setMonth(parseFloat(t)-1)},n:function(r,t){r.setMonth(parseFloat(t)-1)},s:function(r,t){r.setSeconds(parseFloat(t))},u:function(r,t){return new Date(parseFloat(t))},w:mt,y:function(r,t){r.setFullYear(2e3+parseFloat(t))}},ce={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},Ie={Z:function(r){return r.toISOString()},D:function(r,t,e){return t.weekdays.shorthand[Ie.w(r,t,e)]},F:function(r,t,e){return Qe(Ie.n(r,t,e)-1,!1,t)},G:function(r,t,e){return Y(Ie.h(r,t,e))},H:function(r){return Y(r.getHours())},J:function(r,t){return t.ordinal!==void 0?r.getDate()+t.ordinal(r.getDate()):r.getDate()},K:function(r,t){return t.amPM[W(r.getHours()>11)]},M:function(r,t){return Qe(r.getMonth(),!0,t)},S:function(r){return Y(r.getSeconds())},U:function(r){return r.getTime()/1e3},W:function(r,t,e){return e.getWeek(r)},Y:function(r){return Y(r.getFullYear(),4)},d:function(r){return Y(r.getDate())},h:function(r){return r.getHours()%12?r.getHours()%12:12},i:function(r){return Y(r.getMinutes())},j:function(r){return r.getDate()},l:function(r,t){return t.weekdays.longhand[r.getDay()]},m:function(r){return Y(r.getMonth()+1)},n:function(r){return r.getMonth()+1},s:function(r){return r.getSeconds()},u:function(r){return r.getTime()},w:function(r){return r.getDay()},y:function(r){return String(r.getFullYear()).substring(2)}},yn=function(r){var t=r.config,e=t===void 0?_e:t,n=r.l10n,i=n===void 0?Re:n,s=r.isMobile,a=s===void 0?!1:s;return function(c,u,f){var h=f||i;return e.formatDate!==void 0&&!a?e.formatDate(c,u,h):u.split("").map(function(p,v,D){return Ie[p]&&D[v-1]!=="\\"?Ie[p](c,h,e):p!=="\\"?p:""}).join("")}},kt=function(r){var t=r.config,e=t===void 0?_e:t,n=r.l10n,i=n===void 0?Re:n;return function(s,a,c,u){if(!(s!==0&&!s)){var f=u||i,h,p=s;if(s instanceof Date)h=new Date(s.getTime());else if(typeof s!="string"&&s.toFixed!==void 0)h=new Date(s);else if(typeof s=="string"){var v=a||(e||_e).dateFormat,D=String(s).trim();if(D==="today")h=new Date,c=!0;else if(e&&e.parseDate)h=e.parseDate(s,v);else if(/Z$/.test(D)||/GMT$/.test(D))h=new Date(s);else{for(var T=void 0,_=[],E=0,R=0,L="";E<v.length;E++){var F=v[E],I=F==="\\",Z=v[E-1]==="\\"||I;if(ce[F]&&!Z){L+=ce[F];var re=new RegExp(L).exec(s);re&&(T=!0)&&_[F!=="Y"?"push":"unshift"]({fn:Qi[F],val:re[++R]})}else I||(L+=".")}h=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),_.forEach(function(ue){var de=ue.fn,et=ue.val;return h=de(h,et,f)||h}),h=T?h:void 0}}if(!(h instanceof Date&&!isNaN(h.getTime()))){e.errorHandler(new Error("Invalid date provided: "+p));return}return c===!0&&h.setHours(0,0,0,0),h}}};function B(r,t,e){return e===void 0&&(e=!0),e!==!1?new Date(r.getTime()).setHours(0,0,0,0)-new Date(t.getTime()).setHours(0,0,0,0):r.getTime()-t.getTime()}var Xi=function(r,t,e){return r>Math.min(t,e)&&r<Math.max(t,e)},vt=function(r,t,e){return r*3600+t*60+e},Zi=function(r){var t=Math.floor(r/3600),e=(r-t*3600)/60;return[t,e,r-t*3600-e*60]},es={DAY:864e5};function yt(r){var t=r.defaultHour,e=r.defaultMinute,n=r.defaultSeconds;if(r.minDate!==void 0){var i=r.minDate.getHours(),s=r.minDate.getMinutes(),a=r.minDate.getSeconds();t<i&&(t=i),t===i&&e<s&&(e=s),t===i&&e===s&&n<a&&(n=r.minDate.getSeconds())}if(r.maxDate!==void 0){var c=r.maxDate.getHours(),u=r.maxDate.getMinutes();t=Math.min(t,c),t===c&&(e=Math.min(u,e)),t===c&&e===u&&(n=r.maxDate.getSeconds())}return{hours:t,minutes:e,seconds:n}}typeof Object.assign!="function"&&(Object.assign=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(!r)throw TypeError("Cannot convert undefined or null to object");for(var n=function(c){c&&Object.keys(c).forEach(function(u){return r[u]=c[u]})},i=0,s=t;i<s.length;i++){var a=s[i];n(a)}return r});var U=globalThis&&globalThis.__assign||function(){return U=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},U.apply(this,arguments)},an=globalThis&&globalThis.__spreadArrays||function(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),i=0,t=0;t<e;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n},ts=300;function ns(r,t){var e={config:U(U({},_e),$.defaultConfig),l10n:Re};e.parseDate=kt({config:e.config,l10n:e.l10n}),e._handlers=[],e.pluginElements=[],e.loadedPlugins=[],e._bind=_,e._setHoursFromDate=v,e._positionCalendar=qe,e.changeMonth=tt,e.changeYear=Ue,e.clear=Cn,e.close=Sn,e.onMouseOver=Ye,e._createElement=M,e.createDay=re,e.destroy=Tn,e.isEnabled=ie,e.jumpToDate=L,e.updateValue=Q,e.open=xn,e.redraw=Ft,e.set=In,e.setDate=Pn,e.toggle=Fn;function n(){e.utils={getDaysInMonth:function(o,l){return o===void 0&&(o=e.currentMonth),l===void 0&&(l=e.currentYear),o===1&&(l%4===0&&l%100!==0||l%400===0)?29:e.l10n.daysInMonth[o]}}}function i(){e.element=e.input=r,e.isOpen=!1,Mn(),Lt(),Rn(),$n(),n(),e.isMobile||Z(),R(),(e.selectedDates.length||e.config.noCalendar)&&(e.config.enableTime&&v(e.config.noCalendar?e.latestSelectedDateObj:void 0),Q(!1)),c();var o=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!e.isMobile&&o&&qe(),P("onReady")}function s(){var o;return((o=e.calendarContainer)===null||o===void 0?void 0:o.getRootNode()).activeElement||document.activeElement}function a(o){return o.bind(e)}function c(){var o=e.config;o.weekNumbers===!1&&o.showMonths===1||o.noCalendar!==!0&&window.requestAnimationFrame(function(){if(e.calendarContainer!==void 0&&(e.calendarContainer.style.visibility="hidden",e.calendarContainer.style.display="block"),e.daysContainer!==void 0){var l=(e.days.offsetWidth+1)*o.showMonths;e.daysContainer.style.width=l+"px",e.calendarContainer.style.width=l+(e.weekWrapper!==void 0?e.weekWrapper.offsetWidth:0)+"px",e.calendarContainer.style.removeProperty("visibility"),e.calendarContainer.style.removeProperty("display")}})}function u(o){if(e.selectedDates.length===0){var l=e.config.minDate===void 0||B(new Date,e.config.minDate)>=0?new Date:new Date(e.config.minDate.getTime()),d=yt(e.config);l.setHours(d.hours,d.minutes,d.seconds,l.getMilliseconds()),e.selectedDates=[l],e.latestSelectedDateObj=l}o!==void 0&&o.type!=="blur"&&Hn(o);var g=e._input.value;p(),Q(),e._input.value!==g&&e._debouncedChange()}function f(o,l){return o%12+12*W(l===e.l10n.amPM[1])}function h(o){switch(o%24){case 0:case 12:return 12;default:return o%12}}function p(){if(!(e.hourElement===void 0||e.minuteElement===void 0)){var o=(parseInt(e.hourElement.value.slice(-2),10)||0)%24,l=(parseInt(e.minuteElement.value,10)||0)%60,d=e.secondElement!==void 0?(parseInt(e.secondElement.value,10)||0)%60:0;e.amPM!==void 0&&(o=f(o,e.amPM.textContent));var g=e.config.minTime!==void 0||e.config.minDate&&e.minDateHasTime&&e.latestSelectedDateObj&&B(e.latestSelectedDateObj,e.config.minDate,!0)===0,m=e.config.maxTime!==void 0||e.config.maxDate&&e.maxDateHasTime&&e.latestSelectedDateObj&&B(e.latestSelectedDateObj,e.config.maxDate,!0)===0;if(e.config.maxTime!==void 0&&e.config.minTime!==void 0&&e.config.minTime>e.config.maxTime){var y=vt(e.config.minTime.getHours(),e.config.minTime.getMinutes(),e.config.minTime.getSeconds()),C=vt(e.config.maxTime.getHours(),e.config.maxTime.getMinutes(),e.config.maxTime.getSeconds()),w=vt(o,l,d);if(w>C&&w<y){var S=Zi(y);o=S[0],l=S[1],d=S[2]}}else{if(m){var b=e.config.maxTime!==void 0?e.config.maxTime:e.config.maxDate;o=Math.min(o,b.getHours()),o===b.getHours()&&(l=Math.min(l,b.getMinutes())),l===b.getMinutes()&&(d=Math.min(d,b.getSeconds()))}if(g){var k=e.config.minTime!==void 0?e.config.minTime:e.config.minDate;o=Math.max(o,k.getHours()),o===k.getHours()&&l<k.getMinutes()&&(l=k.getMinutes()),l===k.getMinutes()&&(d=Math.max(d,k.getSeconds()))}}D(o,l,d)}}function v(o){var l=o||e.latestSelectedDateObj;l&&l instanceof Date&&D(l.getHours(),l.getMinutes(),l.getSeconds())}function D(o,l,d){e.latestSelectedDateObj!==void 0&&e.latestSelectedDateObj.setHours(o%24,l,d||0,0),!(!e.hourElement||!e.minuteElement||e.isMobile)&&(e.hourElement.value=Y(e.config.time_24hr?o:(12+o)%12+12*W(o%12===0)),e.minuteElement.value=Y(l),e.amPM!==void 0&&(e.amPM.textContent=e.l10n.amPM[W(o>=12)]),e.secondElement!==void 0&&(e.secondElement.value=Y(d)))}function T(o){var l=J(o),d=parseInt(l.value)+(o.delta||0);(d/1e3>1||o.key==="Enter"&&!/[^\d]/.test(d.toString()))&&Ue(d)}function _(o,l,d,g){if(l instanceof Array)return l.forEach(function(m){return _(o,m,d,g)});if(o instanceof Array)return o.forEach(function(m){return _(m,l,d,g)});o.addEventListener(l,d,g),e._handlers.push({remove:function(){return o.removeEventListener(l,d,g)}})}function E(){P("onChange")}function R(){if(e.config.wrap&&["open","close","toggle","clear"].forEach(function(d){Array.prototype.forEach.call(e.element.querySelectorAll("[data-"+d+"]"),function(g){return _(g,"click",e[d])})}),e.isMobile){Ln();return}var o=sn(On,50);if(e._debouncedChange=sn(E,ts),e.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&_(e.daysContainer,"mouseover",function(d){e.config.mode==="range"&&Ye(J(d))}),_(e._input,"keydown",Pt),e.calendarContainer!==void 0&&_(e.calendarContainer,"keydown",Pt),!e.config.inline&&!e.config.static&&_(window,"resize",o),window.ontouchstart!==void 0?_(window.document,"touchstart",nt):_(window.document,"mousedown",nt),_(window.document,"focus",nt,{capture:!0}),e.config.clickOpens===!0&&(_(e._input,"focus",e.open),_(e._input,"click",e.open)),e.daysContainer!==void 0&&(_(e.monthNav,"click",Un),_(e.monthNav,["keyup","increment"],T),_(e.daysContainer,"click",Nt)),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0){var l=function(d){return J(d).select()};_(e.timeContainer,["increment"],u),_(e.timeContainer,"blur",u,{capture:!0}),_(e.timeContainer,"click",F),_([e.hourElement,e.minuteElement],["focus","click"],l),e.secondElement!==void 0&&_(e.secondElement,"focus",function(){return e.secondElement&&e.secondElement.select()}),e.amPM!==void 0&&_(e.amPM,"click",function(d){u(d)})}e.config.allowInput&&_(e._input,"blur",En)}function L(o,l){var d=o!==void 0?e.parseDate(o):e.latestSelectedDateObj||(e.config.minDate&&e.config.minDate>e.now?e.config.minDate:e.config.maxDate&&e.config.maxDate<e.now?e.config.maxDate:e.now),g=e.currentYear,m=e.currentMonth;try{d!==void 0&&(e.currentYear=d.getFullYear(),e.currentMonth=d.getMonth())}catch(y){y.message="Invalid date supplied: "+d,e.config.errorHandler(y)}l&&e.currentYear!==g&&(P("onYearChange"),he()),l&&(e.currentYear!==g||e.currentMonth!==m)&&P("onMonthChange"),e.redraw()}function F(o){var l=J(o);~l.className.indexOf("arrow")&&I(o,l.classList.contains("arrowUp")?1:-1)}function I(o,l,d){var g=o&&J(o),m=d||g&&g.parentNode&&g.parentNode.firstChild,y=it("increment");y.delta=l,m&&m.dispatchEvent(y)}function Z(){var o=window.document.createDocumentFragment();if(e.calendarContainer=M("div","flatpickr-calendar"),e.calendarContainer.tabIndex=-1,!e.config.noCalendar){if(o.appendChild(wn()),e.innerContainer=M("div","flatpickr-innerContainer"),e.config.weekNumbers){var l=kn(),d=l.weekWrapper,g=l.weekNumbers;e.innerContainer.appendChild(d),e.weekNumbers=g,e.weekWrapper=d}e.rContainer=M("div","flatpickr-rContainer"),e.rContainer.appendChild(At()),e.daysContainer||(e.daysContainer=M("div","flatpickr-days"),e.daysContainer.tabIndex=-1),Ne(),e.rContainer.appendChild(e.daysContainer),e.innerContainer.appendChild(e.rContainer),o.appendChild(e.innerContainer)}e.config.enableTime&&o.appendChild(Dn()),H(e.calendarContainer,"rangeMode",e.config.mode==="range"),H(e.calendarContainer,"animate",e.config.animate===!0),H(e.calendarContainer,"multiMonth",e.config.showMonths>1),e.calendarContainer.appendChild(o);var m=e.config.appendTo!==void 0&&e.config.appendTo.nodeType!==void 0;if((e.config.inline||e.config.static)&&(e.calendarContainer.classList.add(e.config.inline?"inline":"static"),e.config.inline&&(!m&&e.element.parentNode?e.element.parentNode.insertBefore(e.calendarContainer,e._input.nextSibling):e.config.appendTo!==void 0&&e.config.appendTo.appendChild(e.calendarContainer)),e.config.static)){var y=M("div","flatpickr-wrapper");e.element.parentNode&&e.element.parentNode.insertBefore(y,e.element),y.appendChild(e.element),e.altInput&&y.appendChild(e.altInput),y.appendChild(e.calendarContainer)}!e.config.static&&!e.config.inline&&(e.config.appendTo!==void 0?e.config.appendTo:window.document.body).appendChild(e.calendarContainer)}function re(o,l,d,g){var m=ie(l,!0),y=M("span",o,l.getDate().toString());return y.dateObj=l,y.$i=g,y.setAttribute("aria-label",e.formatDate(l,e.config.ariaDateFormat)),o.indexOf("hidden")===-1&&B(l,e.now)===0&&(e.todayDateElem=y,y.classList.add("today"),y.setAttribute("aria-current","date")),m?(y.tabIndex=-1,st(l)&&(y.classList.add("selected"),e.selectedDateElem=y,e.config.mode==="range"&&(H(y,"startRange",e.selectedDates[0]&&B(l,e.selectedDates[0],!0)===0),H(y,"endRange",e.selectedDates[1]&&B(l,e.selectedDates[1],!0)===0),o==="nextMonthDay"&&y.classList.add("inRange")))):y.classList.add("flatpickr-disabled"),e.config.mode==="range"&&Nn(l)&&!st(l)&&y.classList.add("inRange"),e.weekNumbers&&e.config.showMonths===1&&o!=="prevMonthDay"&&g%7===6&&e.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+e.config.getWeek(l)+"</span>"),P("onDayCreate",y),y}function ue(o){o.focus(),e.config.mode==="range"&&Ye(o)}function de(o){for(var l=o>0?0:e.config.showMonths-1,d=o>0?e.config.showMonths:-1,g=l;g!=d;g+=o)for(var m=e.daysContainer.children[g],y=o>0?0:m.children.length-1,C=o>0?m.children.length:-1,w=y;w!=C;w+=o){var S=m.children[w];if(S.className.indexOf("hidden")===-1&&ie(S.dateObj))return S}}function et(o,l){for(var d=o.className.indexOf("Month")===-1?o.dateObj.getMonth():e.currentMonth,g=l>0?e.config.showMonths:-1,m=l>0?1:-1,y=d-e.currentMonth;y!=g;y+=m)for(var C=e.daysContainer.children[y],w=d-e.currentMonth===y?o.$i+l:l<0?C.children.length-1:0,S=C.children.length,b=w;b>=0&&b<S&&b!=(l>0?S:-1);b+=m){var k=C.children[b];if(k.className.indexOf("hidden")===-1&&ie(k.dateObj)&&Math.abs(o.$i-b)>=Math.abs(l))return ue(k)}e.changeMonth(m),Ce(de(m),0)}function Ce(o,l){var d=s(),g=He(d||document.body),m=o!==void 0?o:g?d:e.selectedDateElem!==void 0&&He(e.selectedDateElem)?e.selectedDateElem:e.todayDateElem!==void 0&&He(e.todayDateElem)?e.todayDateElem:de(l>0?1:-1);m===void 0?e._input.focus():g?et(m,l):ue(m)}function _n(o,l){for(var d=(new Date(o,l,1).getDay()-e.l10n.firstDayOfWeek+7)%7,g=e.utils.getDaysInMonth((l-1+12)%12,o),m=e.utils.getDaysInMonth(l,o),y=window.document.createDocumentFragment(),C=e.config.showMonths>1,w=C?"prevMonthDay hidden":"prevMonthDay",S=C?"nextMonthDay hidden":"nextMonthDay",b=g+1-d,k=0;b<=g;b++,k++)y.appendChild(re("flatpickr-day "+w,new Date(o,l-1,b),b,k));for(b=1;b<=m;b++,k++)y.appendChild(re("flatpickr-day",new Date(o,l,b),b,k));for(var j=m+1;j<=42-d&&(e.config.showMonths===1||k%7!==0);j++,k++)y.appendChild(re("flatpickr-day "+S,new Date(o,l+1,j%m),j,k));var V=M("div","dayContainer");return V.appendChild(y),V}function Ne(){if(e.daysContainer!==void 0){Ge(e.daysContainer),e.weekNumbers&&Ge(e.weekNumbers);for(var o=document.createDocumentFragment(),l=0;l<e.config.showMonths;l++){var d=new Date(e.currentYear,e.currentMonth,1);d.setMonth(e.currentMonth+l),o.appendChild(_n(d.getFullYear(),d.getMonth()))}e.daysContainer.appendChild(o),e.days=e.daysContainer.firstChild,e.config.mode==="range"&&e.selectedDates.length===1&&Ye()}}function he(){if(!(e.config.showMonths>1||e.config.monthSelectorType!=="dropdown")){var o=function(g){return e.config.minDate!==void 0&&e.currentYear===e.config.minDate.getFullYear()&&g<e.config.minDate.getMonth()?!1:!(e.config.maxDate!==void 0&&e.currentYear===e.config.maxDate.getFullYear()&&g>e.config.maxDate.getMonth())};e.monthsDropdownContainer.tabIndex=-1,e.monthsDropdownContainer.innerHTML="";for(var l=0;l<12;l++)if(o(l)){var d=M("option","flatpickr-monthDropdown-month");d.value=new Date(e.currentYear,l).getMonth().toString(),d.textContent=Qe(l,e.config.shorthandCurrentMonth,e.l10n),d.tabIndex=-1,e.currentMonth===l&&(d.selected=!0),e.monthsDropdownContainer.appendChild(d)}}}function bn(){var o=M("div","flatpickr-month"),l=window.document.createDocumentFragment(),d;e.config.showMonths>1||e.config.monthSelectorType==="static"?d=M("span","cur-month"):(e.monthsDropdownContainer=M("select","flatpickr-monthDropdown-months"),e.monthsDropdownContainer.setAttribute("aria-label",e.l10n.monthAriaLabel),_(e.monthsDropdownContainer,"change",function(C){var w=J(C),S=parseInt(w.value,10);e.changeMonth(S-e.currentMonth),P("onMonthChange")}),he(),d=e.monthsDropdownContainer);var g=Ve("cur-year",{tabindex:"-1"}),m=g.getElementsByTagName("input")[0];m.setAttribute("aria-label",e.l10n.yearAriaLabel),e.config.minDate&&m.setAttribute("min",e.config.minDate.getFullYear().toString()),e.config.maxDate&&(m.setAttribute("max",e.config.maxDate.getFullYear().toString()),m.disabled=!!e.config.minDate&&e.config.minDate.getFullYear()===e.config.maxDate.getFullYear());var y=M("div","flatpickr-current-month");return y.appendChild(d),y.appendChild(g),l.appendChild(y),o.appendChild(l),{container:o,yearElement:m,monthElement:d}}function jt(){Ge(e.monthNav),e.monthNav.appendChild(e.prevMonthNav),e.config.showMonths&&(e.yearElements=[],e.monthElements=[]);for(var o=e.config.showMonths;o--;){var l=bn();e.yearElements.push(l.yearElement),e.monthElements.push(l.monthElement),e.monthNav.appendChild(l.container)}e.monthNav.appendChild(e.nextMonthNav)}function wn(){return e.monthNav=M("div","flatpickr-months"),e.yearElements=[],e.monthElements=[],e.prevMonthNav=M("span","flatpickr-prev-month"),e.prevMonthNav.innerHTML=e.config.prevArrow,e.nextMonthNav=M("span","flatpickr-next-month"),e.nextMonthNav.innerHTML=e.config.nextArrow,jt(),Object.defineProperty(e,"_hidePrevMonthArrow",{get:function(){return e.__hidePrevMonthArrow},set:function(o){e.__hidePrevMonthArrow!==o&&(H(e.prevMonthNav,"flatpickr-disabled",o),e.__hidePrevMonthArrow=o)}}),Object.defineProperty(e,"_hideNextMonthArrow",{get:function(){return e.__hideNextMonthArrow},set:function(o){e.__hideNextMonthArrow!==o&&(H(e.nextMonthNav,"flatpickr-disabled",o),e.__hideNextMonthArrow=o)}}),e.currentYearElement=e.yearElements[0],Be(),e.monthNav}function Dn(){e.calendarContainer.classList.add("hasTime"),e.config.noCalendar&&e.calendarContainer.classList.add("noCalendar");var o=yt(e.config);e.timeContainer=M("div","flatpickr-time"),e.timeContainer.tabIndex=-1;var l=M("span","flatpickr-time-separator",":"),d=Ve("flatpickr-hour",{"aria-label":e.l10n.hourAriaLabel});e.hourElement=d.getElementsByTagName("input")[0];var g=Ve("flatpickr-minute",{"aria-label":e.l10n.minuteAriaLabel});if(e.minuteElement=g.getElementsByTagName("input")[0],e.hourElement.tabIndex=e.minuteElement.tabIndex=-1,e.hourElement.value=Y(e.latestSelectedDateObj?e.latestSelectedDateObj.getHours():e.config.time_24hr?o.hours:h(o.hours)),e.minuteElement.value=Y(e.latestSelectedDateObj?e.latestSelectedDateObj.getMinutes():o.minutes),e.hourElement.setAttribute("step",e.config.hourIncrement.toString()),e.minuteElement.setAttribute("step",e.config.minuteIncrement.toString()),e.hourElement.setAttribute("min",e.config.time_24hr?"0":"1"),e.hourElement.setAttribute("max",e.config.time_24hr?"23":"12"),e.hourElement.setAttribute("maxlength","2"),e.minuteElement.setAttribute("min","0"),e.minuteElement.setAttribute("max","59"),e.minuteElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(d),e.timeContainer.appendChild(l),e.timeContainer.appendChild(g),e.config.time_24hr&&e.timeContainer.classList.add("time24hr"),e.config.enableSeconds){e.timeContainer.classList.add("hasSeconds");var m=Ve("flatpickr-second");e.secondElement=m.getElementsByTagName("input")[0],e.secondElement.value=Y(e.latestSelectedDateObj?e.latestSelectedDateObj.getSeconds():o.seconds),e.secondElement.setAttribute("step",e.minuteElement.getAttribute("step")),e.secondElement.setAttribute("min","0"),e.secondElement.setAttribute("max","59"),e.secondElement.setAttribute("maxlength","2"),e.timeContainer.appendChild(M("span","flatpickr-time-separator",":")),e.timeContainer.appendChild(m)}return e.config.time_24hr||(e.amPM=M("span","flatpickr-am-pm",e.l10n.amPM[W((e.latestSelectedDateObj?e.hourElement.value:e.config.defaultHour)>11)]),e.amPM.title=e.l10n.toggleTitle,e.amPM.tabIndex=-1,e.timeContainer.appendChild(e.amPM)),e.timeContainer}function At(){e.weekdayContainer?Ge(e.weekdayContainer):e.weekdayContainer=M("div","flatpickr-weekdays");for(var o=e.config.showMonths;o--;){var l=M("div","flatpickr-weekdaycontainer");e.weekdayContainer.appendChild(l)}return It(),e.weekdayContainer}function It(){if(e.weekdayContainer){var o=e.l10n.firstDayOfWeek,l=an(e.l10n.weekdays.shorthand);o>0&&o<l.length&&(l=an(l.splice(o,l.length),l.splice(0,o)));for(var d=e.config.showMonths;d--;)e.weekdayContainer.children[d].innerHTML=`
      <span class='flatpickr-weekday'>
        `+l.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function kn(){e.calendarContainer.classList.add("hasWeeks");var o=M("div","flatpickr-weekwrapper");o.appendChild(M("span","flatpickr-weekday",e.l10n.weekAbbreviation));var l=M("div","flatpickr-weeks");return o.appendChild(l),{weekWrapper:o,weekNumbers:l}}function tt(o,l){l===void 0&&(l=!0);var d=l?o:o-e.currentMonth;d<0&&e._hidePrevMonthArrow===!0||d>0&&e._hideNextMonthArrow===!0||(e.currentMonth+=d,(e.currentMonth<0||e.currentMonth>11)&&(e.currentYear+=e.currentMonth>11?1:-1,e.currentMonth=(e.currentMonth+12)%12,P("onYearChange"),he()),Ne(),P("onMonthChange"),Be())}function Cn(o,l){if(o===void 0&&(o=!0),l===void 0&&(l=!0),e.input.value="",e.altInput!==void 0&&(e.altInput.value=""),e.mobileInput!==void 0&&(e.mobileInput.value=""),e.selectedDates=[],e.latestSelectedDateObj=void 0,l===!0&&(e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth()),e.config.enableTime===!0){var d=yt(e.config),g=d.hours,m=d.minutes,y=d.seconds;D(g,m,y)}e.redraw(),o&&P("onChange")}function Sn(){e.isOpen=!1,e.isMobile||(e.calendarContainer!==void 0&&e.calendarContainer.classList.remove("open"),e._input!==void 0&&e._input.classList.remove("active")),P("onClose")}function Tn(){e.config!==void 0&&P("onDestroy");for(var o=e._handlers.length;o--;)e._handlers[o].remove();if(e._handlers=[],e.mobileInput)e.mobileInput.parentNode&&e.mobileInput.parentNode.removeChild(e.mobileInput),e.mobileInput=void 0;else if(e.calendarContainer&&e.calendarContainer.parentNode)if(e.config.static&&e.calendarContainer.parentNode){var l=e.calendarContainer.parentNode;if(l.lastChild&&l.removeChild(l.lastChild),l.parentNode){for(;l.firstChild;)l.parentNode.insertBefore(l.firstChild,l);l.parentNode.removeChild(l)}}else e.calendarContainer.parentNode.removeChild(e.calendarContainer);e.altInput&&(e.input.type="text",e.altInput.parentNode&&e.altInput.parentNode.removeChild(e.altInput),delete e.altInput),e.input&&(e.input.type=e.input._type,e.input.classList.remove("flatpickr-input"),e.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(d){try{delete e[d]}catch{}})}function Se(o){return e.calendarContainer.contains(o)}function nt(o){if(e.isOpen&&!e.config.inline){var l=J(o),d=Se(l),g=l===e.input||l===e.altInput||e.element.contains(l)||o.path&&o.path.indexOf&&(~o.path.indexOf(e.input)||~o.path.indexOf(e.altInput)),m=!g&&!d&&!Se(o.relatedTarget),y=!e.config.ignoredFocusElements.some(function(C){return C.contains(l)});m&&y&&(e.config.allowInput&&e.setDate(e._input.value,!1,e.config.altInput?e.config.altFormat:e.config.dateFormat),e.timeContainer!==void 0&&e.minuteElement!==void 0&&e.hourElement!==void 0&&e.input.value!==""&&e.input.value!==void 0&&u(),e.close(),e.config&&e.config.mode==="range"&&e.selectedDates.length===1&&e.clear(!1))}}function Ue(o){if(!(!o||e.config.minDate&&o<e.config.minDate.getFullYear()||e.config.maxDate&&o>e.config.maxDate.getFullYear())){var l=o,d=e.currentYear!==l;e.currentYear=l||e.currentYear,e.config.maxDate&&e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth=Math.min(e.config.maxDate.getMonth(),e.currentMonth):e.config.minDate&&e.currentYear===e.config.minDate.getFullYear()&&(e.currentMonth=Math.max(e.config.minDate.getMonth(),e.currentMonth)),d&&(e.redraw(),P("onYearChange"),he())}}function ie(o,l){var d;l===void 0&&(l=!0);var g=e.parseDate(o,void 0,l);if(e.config.minDate&&g&&B(g,e.config.minDate,l!==void 0?l:!e.minDateHasTime)<0||e.config.maxDate&&g&&B(g,e.config.maxDate,l!==void 0?l:!e.maxDateHasTime)>0)return!1;if(!e.config.enable&&e.config.disable.length===0)return!0;if(g===void 0)return!1;for(var m=!!e.config.enable,y=(d=e.config.enable)!==null&&d!==void 0?d:e.config.disable,C=0,w=void 0;C<y.length;C++){if(w=y[C],typeof w=="function"&&w(g))return m;if(w instanceof Date&&g!==void 0&&w.getTime()===g.getTime())return m;if(typeof w=="string"){var S=e.parseDate(w,void 0,!0);return S&&S.getTime()===g.getTime()?m:!m}else if(typeof w=="object"&&g!==void 0&&w.from&&w.to&&g.getTime()>=w.from.getTime()&&g.getTime()<=w.to.getTime())return m}return!m}function He(o){return e.daysContainer!==void 0?o.className.indexOf("hidden")===-1&&o.className.indexOf("flatpickr-disabled")===-1&&e.daysContainer.contains(o):!1}function En(o){var l=o.target===e._input,d=e._input.value.trimEnd()!==at();l&&d&&!(o.relatedTarget&&Se(o.relatedTarget))&&e.setDate(e._input.value,!0,o.target===e.altInput?e.config.altFormat:e.config.dateFormat)}function Pt(o){var l=J(o),d=e.config.wrap?r.contains(l):l===e._input,g=e.config.allowInput,m=e.isOpen&&(!g||!d),y=e.config.inline&&d&&!g;if(o.keyCode===13&&d){if(g)return e.setDate(e._input.value,!0,l===e.altInput?e.config.altFormat:e.config.dateFormat),e.close(),l.blur();e.open()}else if(Se(l)||m||y){var C=!!e.timeContainer&&e.timeContainer.contains(l);switch(o.keyCode){case 13:C?(o.preventDefault(),u(),rt()):Nt(o);break;case 27:o.preventDefault(),rt();break;case 8:case 46:d&&!e.config.allowInput&&(o.preventDefault(),e.clear());break;case 37:case 39:if(!C&&!d){o.preventDefault();var w=s();if(e.daysContainer!==void 0&&(g===!1||w&&He(w))){var S=o.keyCode===39?1:-1;o.ctrlKey?(o.stopPropagation(),tt(S),Ce(de(1),0)):Ce(void 0,S)}}else e.hourElement&&e.hourElement.focus();break;case 38:case 40:o.preventDefault();var b=o.keyCode===40?1:-1;e.daysContainer&&l.$i!==void 0||l===e.input||l===e.altInput?o.ctrlKey?(o.stopPropagation(),Ue(e.currentYear-b),Ce(de(1),0)):C||Ce(void 0,b*7):l===e.currentYearElement?Ue(e.currentYear-b):e.config.enableTime&&(!C&&e.hourElement&&e.hourElement.focus(),u(o),e._debouncedChange());break;case 9:if(C){var k=[e.hourElement,e.minuteElement,e.secondElement,e.amPM].concat(e.pluginElements).filter(function(q){return q}),j=k.indexOf(l);if(j!==-1){var V=k[j+(o.shiftKey?-1:1)];o.preventDefault(),(V||e._input).focus()}}else!e.config.noCalendar&&e.daysContainer&&e.daysContainer.contains(l)&&o.shiftKey&&(o.preventDefault(),e._input.focus());break}}if(e.amPM!==void 0&&l===e.amPM)switch(o.key){case e.l10n.amPM[0].charAt(0):case e.l10n.amPM[0].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[0],p(),Q();break;case e.l10n.amPM[1].charAt(0):case e.l10n.amPM[1].charAt(0).toLowerCase():e.amPM.textContent=e.l10n.amPM[1],p(),Q();break}(d||Se(l))&&P("onKeyDown",o)}function Ye(o,l){if(l===void 0&&(l="flatpickr-day"),!(e.selectedDates.length!==1||o&&(!o.classList.contains(l)||o.classList.contains("flatpickr-disabled")))){for(var d=o?o.dateObj.getTime():e.days.firstElementChild.dateObj.getTime(),g=e.parseDate(e.selectedDates[0],void 0,!0).getTime(),m=Math.min(d,e.selectedDates[0].getTime()),y=Math.max(d,e.selectedDates[0].getTime()),C=!1,w=0,S=0,b=m;b<y;b+=es.DAY)ie(new Date(b),!0)||(C=C||b>m&&b<y,b<g&&(!w||b>w)?w=b:b>g&&(!S||b<S)&&(S=b));var k=Array.from(e.rContainer.querySelectorAll("*:nth-child(-n+"+e.config.showMonths+") > ."+l));k.forEach(function(j){var V=j.dateObj,q=V.getTime(),Te=w>0&&q<w||S>0&&q>S;if(Te){j.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(fe){j.classList.remove(fe)});return}else if(C&&!Te)return;["startRange","inRange","endRange","notAllowed"].forEach(function(fe){j.classList.remove(fe)}),o!==void 0&&(o.classList.add(d<=e.selectedDates[0].getTime()?"startRange":"endRange"),g<d&&q===g?j.classList.add("startRange"):g>d&&q===g&&j.classList.add("endRange"),q>=w&&(S===0||q<=S)&&Xi(q,g,d)&&j.classList.add("inRange"))})}}function On(){e.isOpen&&!e.config.static&&!e.config.inline&&qe()}function xn(o,l){if(l===void 0&&(l=e._positionElement),e.isMobile===!0){if(o){o.preventDefault();var d=J(o);d&&d.blur()}e.mobileInput!==void 0&&(e.mobileInput.focus(),e.mobileInput.click()),P("onOpen");return}else if(e._input.disabled||e.config.inline)return;var g=e.isOpen;e.isOpen=!0,g||(e.calendarContainer.classList.add("open"),e._input.classList.add("active"),P("onOpen"),qe(l)),e.config.enableTime===!0&&e.config.noCalendar===!0&&e.config.allowInput===!1&&(o===void 0||!e.timeContainer.contains(o.relatedTarget))&&setTimeout(function(){return e.hourElement.select()},50)}function $t(o){return function(l){var d=e.config["_"+o+"Date"]=e.parseDate(l,e.config.dateFormat),g=e.config["_"+(o==="min"?"max":"min")+"Date"];d!==void 0&&(e[o==="min"?"minDateHasTime":"maxDateHasTime"]=d.getHours()>0||d.getMinutes()>0||d.getSeconds()>0),e.selectedDates&&(e.selectedDates=e.selectedDates.filter(function(m){return ie(m)}),!e.selectedDates.length&&o==="min"&&v(d),Q()),e.daysContainer&&(Ft(),d!==void 0?e.currentYearElement[o]=d.getFullYear().toString():e.currentYearElement.removeAttribute(o),e.currentYearElement.disabled=!!g&&d!==void 0&&g.getFullYear()===d.getFullYear())}}function Mn(){var o=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],l=U(U({},JSON.parse(JSON.stringify(r.dataset||{}))),t),d={};e.config.parseDate=l.parseDate,e.config.formatDate=l.formatDate,Object.defineProperty(e.config,"enable",{get:function(){return e.config._enable},set:function(k){e.config._enable=Ht(k)}}),Object.defineProperty(e.config,"disable",{get:function(){return e.config._disable},set:function(k){e.config._disable=Ht(k)}});var g=l.mode==="time";if(!l.dateFormat&&(l.enableTime||g)){var m=$.defaultConfig.dateFormat||_e.dateFormat;d.dateFormat=l.noCalendar||g?"H:i"+(l.enableSeconds?":S":""):m+" H:i"+(l.enableSeconds?":S":"")}if(l.altInput&&(l.enableTime||g)&&!l.altFormat){var y=$.defaultConfig.altFormat||_e.altFormat;d.altFormat=l.noCalendar||g?"h:i"+(l.enableSeconds?":S K":" K"):y+(" h:i"+(l.enableSeconds?":S":"")+" K")}Object.defineProperty(e.config,"minDate",{get:function(){return e.config._minDate},set:$t("min")}),Object.defineProperty(e.config,"maxDate",{get:function(){return e.config._maxDate},set:$t("max")});var C=function(k){return function(j){e.config[k==="min"?"_minTime":"_maxTime"]=e.parseDate(j,"H:i:S")}};Object.defineProperty(e.config,"minTime",{get:function(){return e.config._minTime},set:C("min")}),Object.defineProperty(e.config,"maxTime",{get:function(){return e.config._maxTime},set:C("max")}),l.mode==="time"&&(e.config.noCalendar=!0,e.config.enableTime=!0),Object.assign(e.config,d,l);for(var w=0;w<o.length;w++)e.config[o[w]]=e.config[o[w]]===!0||e.config[o[w]]==="true";gt.filter(function(k){return e.config[k]!==void 0}).forEach(function(k){e.config[k]=pt(e.config[k]||[]).map(a)}),e.isMobile=!e.config.disableMobile&&!e.config.inline&&e.config.mode==="single"&&!e.config.disable.length&&!e.config.enable&&!e.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var w=0;w<e.config.plugins.length;w++){var S=e.config.plugins[w](e)||{};for(var b in S)gt.indexOf(b)>-1?e.config[b]=pt(S[b]).map(a).concat(e.config[b]):typeof l[b]>"u"&&(e.config[b]=S[b])}l.altInputClass||(e.config.altInputClass=Rt().className+" "+e.config.altInputClass),P("onParseConfig")}function Rt(){return e.config.wrap?r.querySelector("[data-input]"):r}function Lt(){typeof e.config.locale!="object"&&typeof $.l10ns[e.config.locale]>"u"&&e.config.errorHandler(new Error("flatpickr: invalid locale "+e.config.locale)),e.l10n=U(U({},$.l10ns.default),typeof e.config.locale=="object"?e.config.locale:e.config.locale!=="default"?$.l10ns[e.config.locale]:void 0),ce.D="("+e.l10n.weekdays.shorthand.join("|")+")",ce.l="("+e.l10n.weekdays.longhand.join("|")+")",ce.M="("+e.l10n.months.shorthand.join("|")+")",ce.F="("+e.l10n.months.longhand.join("|")+")",ce.K="("+e.l10n.amPM[0]+"|"+e.l10n.amPM[1]+"|"+e.l10n.amPM[0].toLowerCase()+"|"+e.l10n.amPM[1].toLowerCase()+")";var o=U(U({},t),JSON.parse(JSON.stringify(r.dataset||{})));o.time_24hr===void 0&&$.defaultConfig.time_24hr===void 0&&(e.config.time_24hr=e.l10n.time_24hr),e.formatDate=yn(e),e.parseDate=kt({config:e.config,l10n:e.l10n})}function qe(o){if(typeof e.config.position=="function")return void e.config.position(e,o);if(e.calendarContainer!==void 0){P("onPreCalendarPosition");var l=o||e._positionElement,d=Array.prototype.reduce.call(e.calendarContainer.children,function(Gn,Vn){return Gn+Vn.offsetHeight},0),g=e.calendarContainer.offsetWidth,m=e.config.position.split(" "),y=m[0],C=m.length>1?m[1]:null,w=l.getBoundingClientRect(),S=window.innerHeight-w.bottom,b=y==="above"||y!=="below"&&S<d&&w.top>d,k=window.pageYOffset+w.top+(b?-d-2:l.offsetHeight+2);if(H(e.calendarContainer,"arrowTop",!b),H(e.calendarContainer,"arrowBottom",b),!e.config.inline){var j=window.pageXOffset+w.left,V=!1,q=!1;C==="center"?(j-=(g-w.width)/2,V=!0):C==="right"&&(j-=g-w.width,q=!0),H(e.calendarContainer,"arrowLeft",!V&&!q),H(e.calendarContainer,"arrowCenter",V),H(e.calendarContainer,"arrowRight",q);var Te=window.document.body.offsetWidth-(window.pageXOffset+w.right),fe=j+g>window.document.body.offsetWidth,Yn=Te+g>window.document.body.offsetWidth;if(H(e.calendarContainer,"rightMost",fe),!e.config.static)if(e.calendarContainer.style.top=k+"px",!fe)e.calendarContainer.style.left=j+"px",e.calendarContainer.style.right="auto";else if(!Yn)e.calendarContainer.style.left="auto",e.calendarContainer.style.right=Te+"px";else{var ot=jn();if(ot===void 0)return;var qn=window.document.body.offsetWidth,Jn=Math.max(0,qn/2-g/2),Bn=".flatpickr-calendar.centerMost:before",zn=".flatpickr-calendar.centerMost:after",Kn=ot.cssRules.length,Wn="{left:"+w.left+"px;right:auto;}";H(e.calendarContainer,"rightMost",!1),H(e.calendarContainer,"centerMost",!0),ot.insertRule(Bn+","+zn+Wn,Kn),e.calendarContainer.style.left=Jn+"px",e.calendarContainer.style.right="auto"}}}}function jn(){for(var o=null,l=0;l<document.styleSheets.length;l++){var d=document.styleSheets[l];if(d.cssRules){try{d.cssRules}catch{continue}o=d;break}}return o??An()}function An(){var o=document.createElement("style");return document.head.appendChild(o),o.sheet}function Ft(){e.config.noCalendar||e.isMobile||(he(),Be(),Ne())}function rt(){e._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(e.close,0):e.close()}function Nt(o){o.preventDefault(),o.stopPropagation();var l=function(k){return k.classList&&k.classList.contains("flatpickr-day")&&!k.classList.contains("flatpickr-disabled")&&!k.classList.contains("notAllowed")},d=vn(J(o),l);if(d!==void 0){var g=d,m=e.latestSelectedDateObj=new Date(g.dateObj.getTime()),y=(m.getMonth()<e.currentMonth||m.getMonth()>e.currentMonth+e.config.showMonths-1)&&e.config.mode!=="range";if(e.selectedDateElem=g,e.config.mode==="single")e.selectedDates=[m];else if(e.config.mode==="multiple"){var C=st(m);C?e.selectedDates.splice(parseInt(C),1):e.selectedDates.push(m)}else e.config.mode==="range"&&(e.selectedDates.length===2&&e.clear(!1,!1),e.latestSelectedDateObj=m,e.selectedDates.push(m),B(m,e.selectedDates[0],!0)!==0&&e.selectedDates.sort(function(k,j){return k.getTime()-j.getTime()}));if(p(),y){var w=e.currentYear!==m.getFullYear();e.currentYear=m.getFullYear(),e.currentMonth=m.getMonth(),w&&(P("onYearChange"),he()),P("onMonthChange")}if(Be(),Ne(),Q(),!y&&e.config.mode!=="range"&&e.config.showMonths===1?ue(g):e.selectedDateElem!==void 0&&e.hourElement===void 0&&e.selectedDateElem&&e.selectedDateElem.focus(),e.hourElement!==void 0&&e.hourElement!==void 0&&e.hourElement.focus(),e.config.closeOnSelect){var S=e.config.mode==="single"&&!e.config.enableTime,b=e.config.mode==="range"&&e.selectedDates.length===2&&!e.config.enableTime;(S||b)&&rt()}E()}}var Je={locale:[Lt,It],showMonths:[jt,c,At],minDate:[L],maxDate:[L],positionElement:[Yt],clickOpens:[function(){e.config.clickOpens===!0?(_(e._input,"focus",e.open),_(e._input,"click",e.open)):(e._input.removeEventListener("focus",e.open),e._input.removeEventListener("click",e.open))}]};function In(o,l){if(o!==null&&typeof o=="object"){Object.assign(e.config,o);for(var d in o)Je[d]!==void 0&&Je[d].forEach(function(g){return g()})}else e.config[o]=l,Je[o]!==void 0?Je[o].forEach(function(g){return g()}):gt.indexOf(o)>-1&&(e.config[o]=pt(l));e.redraw(),Q(!0)}function Ut(o,l){var d=[];if(o instanceof Array)d=o.map(function(g){return e.parseDate(g,l)});else if(o instanceof Date||typeof o=="number")d=[e.parseDate(o,l)];else if(typeof o=="string")switch(e.config.mode){case"single":case"time":d=[e.parseDate(o,l)];break;case"multiple":d=o.split(e.config.conjunction).map(function(g){return e.parseDate(g,l)});break;case"range":d=o.split(e.l10n.rangeSeparator).map(function(g){return e.parseDate(g,l)});break}else e.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(o)));e.selectedDates=e.config.allowInvalidPreload?d:d.filter(function(g){return g instanceof Date&&ie(g,!1)}),e.config.mode==="range"&&e.selectedDates.sort(function(g,m){return g.getTime()-m.getTime()})}function Pn(o,l,d){if(l===void 0&&(l=!1),d===void 0&&(d=e.config.dateFormat),o!==0&&!o||o instanceof Array&&o.length===0)return e.clear(l);Ut(o,d),e.latestSelectedDateObj=e.selectedDates[e.selectedDates.length-1],e.redraw(),L(void 0,l),v(),e.selectedDates.length===0&&e.clear(!1),Q(l),l&&P("onChange")}function Ht(o){return o.slice().map(function(l){return typeof l=="string"||typeof l=="number"||l instanceof Date?e.parseDate(l,void 0,!0):l&&typeof l=="object"&&l.from&&l.to?{from:e.parseDate(l.from,void 0),to:e.parseDate(l.to,void 0)}:l}).filter(function(l){return l})}function $n(){e.selectedDates=[],e.now=e.parseDate(e.config.now)||new Date;var o=e.config.defaultDate||((e.input.nodeName==="INPUT"||e.input.nodeName==="TEXTAREA")&&e.input.placeholder&&e.input.value===e.input.placeholder?null:e.input.value);o&&Ut(o,e.config.dateFormat),e._initialDate=e.selectedDates.length>0?e.selectedDates[0]:e.config.minDate&&e.config.minDate.getTime()>e.now.getTime()?e.config.minDate:e.config.maxDate&&e.config.maxDate.getTime()<e.now.getTime()?e.config.maxDate:e.now,e.currentYear=e._initialDate.getFullYear(),e.currentMonth=e._initialDate.getMonth(),e.selectedDates.length>0&&(e.latestSelectedDateObj=e.selectedDates[0]),e.config.minTime!==void 0&&(e.config.minTime=e.parseDate(e.config.minTime,"H:i")),e.config.maxTime!==void 0&&(e.config.maxTime=e.parseDate(e.config.maxTime,"H:i")),e.minDateHasTime=!!e.config.minDate&&(e.config.minDate.getHours()>0||e.config.minDate.getMinutes()>0||e.config.minDate.getSeconds()>0),e.maxDateHasTime=!!e.config.maxDate&&(e.config.maxDate.getHours()>0||e.config.maxDate.getMinutes()>0||e.config.maxDate.getSeconds()>0)}function Rn(){if(e.input=Rt(),!e.input){e.config.errorHandler(new Error("Invalid input element specified"));return}e.input._type=e.input.type,e.input.type="text",e.input.classList.add("flatpickr-input"),e._input=e.input,e.config.altInput&&(e.altInput=M(e.input.nodeName,e.config.altInputClass),e._input=e.altInput,e.altInput.placeholder=e.input.placeholder,e.altInput.disabled=e.input.disabled,e.altInput.required=e.input.required,e.altInput.tabIndex=e.input.tabIndex,e.altInput.type="text",e.input.setAttribute("type","hidden"),!e.config.static&&e.input.parentNode&&e.input.parentNode.insertBefore(e.altInput,e.input.nextSibling)),e.config.allowInput||e._input.setAttribute("readonly","readonly"),Yt()}function Yt(){e._positionElement=e.config.positionElement||e._input}function Ln(){var o=e.config.enableTime?e.config.noCalendar?"time":"datetime-local":"date";e.mobileInput=M("input",e.input.className+" flatpickr-mobile"),e.mobileInput.tabIndex=1,e.mobileInput.type=o,e.mobileInput.disabled=e.input.disabled,e.mobileInput.required=e.input.required,e.mobileInput.placeholder=e.input.placeholder,e.mobileFormatStr=o==="datetime-local"?"Y-m-d\\TH:i:S":o==="date"?"Y-m-d":"H:i:S",e.selectedDates.length>0&&(e.mobileInput.defaultValue=e.mobileInput.value=e.formatDate(e.selectedDates[0],e.mobileFormatStr)),e.config.minDate&&(e.mobileInput.min=e.formatDate(e.config.minDate,"Y-m-d")),e.config.maxDate&&(e.mobileInput.max=e.formatDate(e.config.maxDate,"Y-m-d")),e.input.getAttribute("step")&&(e.mobileInput.step=String(e.input.getAttribute("step"))),e.input.type="hidden",e.altInput!==void 0&&(e.altInput.type="hidden");try{e.input.parentNode&&e.input.parentNode.insertBefore(e.mobileInput,e.input.nextSibling)}catch{}_(e.mobileInput,"change",function(l){e.setDate(J(l).value,!1,e.mobileFormatStr),P("onChange"),P("onClose")})}function Fn(o){if(e.isOpen===!0)return e.close();e.open(o)}function P(o,l){if(e.config!==void 0){var d=e.config[o];if(d!==void 0&&d.length>0)for(var g=0;d[g]&&g<d.length;g++)d[g](e.selectedDates,e.input.value,e,l);o==="onChange"&&(e.input.dispatchEvent(it("change")),e.input.dispatchEvent(it("input")))}}function it(o){var l=document.createEvent("Event");return l.initEvent(o,!0,!0),l}function st(o){for(var l=0;l<e.selectedDates.length;l++){var d=e.selectedDates[l];if(d instanceof Date&&B(d,o)===0)return""+l}return!1}function Nn(o){return e.config.mode!=="range"||e.selectedDates.length<2?!1:B(o,e.selectedDates[0])>=0&&B(o,e.selectedDates[1])<=0}function Be(){e.config.noCalendar||e.isMobile||!e.monthNav||(e.yearElements.forEach(function(o,l){var d=new Date(e.currentYear,e.currentMonth,1);d.setMonth(e.currentMonth+l),e.config.showMonths>1||e.config.monthSelectorType==="static"?e.monthElements[l].textContent=Qe(d.getMonth(),e.config.shorthandCurrentMonth,e.l10n)+" ":e.monthsDropdownContainer.value=d.getMonth().toString(),o.value=d.getFullYear().toString()}),e._hidePrevMonthArrow=e.config.minDate!==void 0&&(e.currentYear===e.config.minDate.getFullYear()?e.currentMonth<=e.config.minDate.getMonth():e.currentYear<e.config.minDate.getFullYear()),e._hideNextMonthArrow=e.config.maxDate!==void 0&&(e.currentYear===e.config.maxDate.getFullYear()?e.currentMonth+1>e.config.maxDate.getMonth():e.currentYear>e.config.maxDate.getFullYear()))}function at(o){var l=o||(e.config.altInput?e.config.altFormat:e.config.dateFormat);return e.selectedDates.map(function(d){return e.formatDate(d,l)}).filter(function(d,g,m){return e.config.mode!=="range"||e.config.enableTime||m.indexOf(d)===g}).join(e.config.mode!=="range"?e.config.conjunction:e.l10n.rangeSeparator)}function Q(o){o===void 0&&(o=!0),e.mobileInput!==void 0&&e.mobileFormatStr&&(e.mobileInput.value=e.latestSelectedDateObj!==void 0?e.formatDate(e.latestSelectedDateObj,e.mobileFormatStr):""),e.input.value=at(e.config.dateFormat),e.altInput!==void 0&&(e.altInput.value=at(e.config.altFormat)),o!==!1&&P("onValueUpdate")}function Un(o){var l=J(o),d=e.prevMonthNav.contains(l),g=e.nextMonthNav.contains(l);d||g?tt(d?-1:1):e.yearElements.indexOf(l)>=0?l.select():l.classList.contains("arrowUp")?e.changeYear(e.currentYear+1):l.classList.contains("arrowDown")&&e.changeYear(e.currentYear-1)}function Hn(o){o.preventDefault();var l=o.type==="keydown",d=J(o),g=d;e.amPM!==void 0&&d===e.amPM&&(e.amPM.textContent=e.l10n.amPM[W(e.amPM.textContent===e.l10n.amPM[0])]);var m=parseFloat(g.getAttribute("min")),y=parseFloat(g.getAttribute("max")),C=parseFloat(g.getAttribute("step")),w=parseInt(g.value,10),S=o.delta||(l?o.which===38?1:-1:0),b=w+C*S;if(typeof g.value<"u"&&g.value.length===2){var k=g===e.hourElement,j=g===e.minuteElement;b<m?(b=y+b+W(!k)+(W(k)&&W(!e.amPM)),j&&I(void 0,-1,e.hourElement)):b>y&&(b=g===e.hourElement?b-y-W(!e.amPM):m,j&&I(void 0,1,e.hourElement)),e.amPM&&k&&(C===1?b+w===23:Math.abs(b-w)>C)&&(e.amPM.textContent=e.l10n.amPM[W(e.amPM.textContent===e.l10n.amPM[0])]),g.value=Y(b)}}return i(),e}function be(r,t){for(var e=Array.prototype.slice.call(r).filter(function(a){return a instanceof HTMLElement}),n=[],i=0;i<e.length;i++){var s=e[i];try{if(s.getAttribute("data-fp-omit")!==null)continue;s._flatpickr!==void 0&&(s._flatpickr.destroy(),s._flatpickr=void 0),s._flatpickr=ns(s,t||{}),n.push(s._flatpickr)}catch(a){console.error(a)}}return n.length===1?n[0]:n}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(r){return be(this,r)},HTMLElement.prototype.flatpickr=function(r){return be([this],r)});var $=function(r,t){return typeof r=="string"?be(window.document.querySelectorAll(r),t):r instanceof Node?be([r],t):be(r,t)};$.defaultConfig={};$.l10ns={en:U({},Re),default:U({},Re)};$.localize=function(r){$.l10ns.default=U(U({},$.l10ns.default),r)};$.setDefaults=function(r){$.defaultConfig=U(U({},$.defaultConfig),r)};$.parseDate=kt({});$.formatDate=yn({});$.compareDates=B;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(r){return be(this,r)});Date.prototype.fp_incr=function(r){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof r=="string"?parseInt(r,10):r))};typeof window<"u"&&(window.flatpickr=$);var Ct={exports:{}};(function(r,t){(function(e,n){n(t)})(hr,function(e){var n=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},i={weekdays:{shorthand:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],longhand:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"]},months:{shorthand:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],longhand:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]},rangeSeparator:" até ",time_24hr:!0};n.l10ns.pt=i;var s=n.l10ns;e.Portuguese=i,e.default=s,Object.defineProperty(e,"__esModule",{value:!0})})})(Ct,Ct.exports);var as=Ct.exports;export{$ as f,is as g,as as p,ss as s};
